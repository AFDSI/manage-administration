# Handoff Document - Profile Generator & Architecture Decisions

**Date:** 2025-10-27  
**Conversation:** Profile Generator Development & ADR Creation  
**Status:** Ready for Next Phase

---

## ğŸ¯ What We Accomplished

### 1. Profile Generator - Production Ready (v18.0.10)
âœ… **PowerShell Profile Generator**
- Fixed 10+ property access errors
- Fixed array trailing comma issues
- Fixed function naming (lowercase to avoid alias issues)
- Fixed prompt display
- **Version:** 18.0.10

âœ… **Unix/Bash Profile Generator**
- Fixed UX display issues
- Corrected platform labels
- Automatic `.bash_profile` creation for login shells
- **Version:** 18.0.10

### 2. All Development Environments Working
âœ… **PowerShell** - Auto-loads, all commands working  
âœ… **Debian/WSL** - Auto-loads with bash_profile  
âœ… **Claude Code** - Verified v2.0.27 working  
âœ… **Windows Terminal** - Configured with all modes

### 3. Architecture Decision Record Created
âœ… **ADR-001: Data-Driven Configuration Architecture**
- Formalizes separation of logic and data
- Mandates externalization of all human-readable strings
- Establishes i18n requirements
- Provides implementation guidelines

---

## ğŸ“¦ Key Files & Locations

### Generator Files
```
E:\users\gigster\workspace\dev\profile-generator\
â”œâ”€â”€ profile-build.ps1              (v18.0.10 - Main generator)
â”œâ”€â”€ profile-values.yaml            (Configuration)
â”œâ”€â”€ profile-helpers-en.yaml        (Content/helpers)
â””â”€â”€ templates\
    â””â”€â”€ unix_builder.sh            (Unix profile generator)
```

### Generated Profiles
```
E:\users\gigster\workspace\dev\profiles\
â”œâ”€â”€ ps\
â”‚   â””â”€â”€ profile.generated.ps1      (PowerShell profile)
â””â”€â”€ bash\
    â””â”€â”€ .bashrc.generated          (Bash profile)
```

### User Profile Files
```
~/.bashrc                          (Sources generated bash profile)
~/.bash_profile                    (Sources .bashrc for login shells)
E:\documents\Documents\PowerShell\
â””â”€â”€ Microsoft.PowerShell_profile.ps1  (Sources generated PS profile)
```

### Documentation
```
/mnt/user-data/outputs/
â”œâ”€â”€ profile-build.ps1              (Latest generator v18.0.10)
â”œâ”€â”€ lessons-learned-powershell.md  (PowerShell gotchas)
â”œâ”€â”€ ADR-001-Data-Driven-Architecture.md  (Architecture decisions)
â””â”€â”€ FIX-SUMMARY-v18.0.10.md        (Latest fix summary)
```

---

## ğŸ† Current State - All Systems Operational

### PowerShell
```powershell
# Command to regenerate:
pwsh -NoProfile -ExecutionPolicy Bypass -File .\profile-build.ps1 `
    -ConfigPath .\profile-values.yaml `
    -HelpersPath .\profile-helpers-en.yaml `
    -UnixTemplatesPath .\templates

# Available commands:
check-versions       # Show tool versions
show-commands <topic>  # Show commands for topic
show-examples <topic>  # Show examples for topic
check-env           # Refresh environment display

# Navigation shortcuts:
amp, home, etc.     # Navigate to directories
```

### Debian/WSL
```bash
# Automatically loads on terminal start
# Available commands:
check_versions       # Show tool versions
show_commands <topic>  # Show commands for topic
show_examples <topic>  # Show examples for topic
check_env           # Refresh environment display

# Navigation shortcuts:
amp, home, etc.     # Navigate to directories

# Claude Code:
claude --version    # v2.0.27
claude --help       # Show help
```

### Windows Terminal Modes
```json
// Configured modes:
- Default PowerShell
- PS AWS (mode: aws)
- PS Google Cloud (mode: google_cloud)  â† Fixed: was "GoogleCloud"
- PS Claude Code (Key Check) - Optional, can hide/remove
- Claude Code (WSL) - Primary Claude Code environment
- Linux Development Environment (Debian WSL)
```

---

## ğŸ“‹ ADR-001 Summary

### Core Principles

**1. Three-Layer Architecture**
```
Immutable Logic Layer (Code)
      â†“
Mutable Data Layer (Config/Content)
      â†“
Generated Output Layer (Profiles/Sites)
```

**2. No Human-Readable Strings in Code**
- ALL user-facing text externalized
- Includes: errors, messages, help text, build output
- Use .po files (gettext) for translations

**3. Configuration-Driven Behavior**
- Paths, features, settings in YAML/JSON
- Never hard-coded in source

**4. Build-Time Binding**
- Config + Templates â†’ Generated output
- Fail at build, not runtime

**5. Schema Validation**
- All configs have schemas
- Validated at build time

### Golden Rule
> **If a human will read it, it goes in a data file, not source code.**

---

## ğŸ”§ Tools & Commands Reference

### File Editing
```bash
# Use VS Code (cross-platform)
code filename.txt           # Open file
code .                      # Open directory
code filename.txt:42        # Open at line 42

# Note: Installing VS Code on both Windows and macOS
# Command: 'code' works everywhere
```

### Windows Terminal
```
Settings â†’ Open JSON file (bottom left)
# Edit profiles, colors, keybindings
# Changes take effect on restart
```

### Profile Regeneration
```powershell
# From: E:\users\gigster\workspace\dev\profile-generator\
pwsh -NoProfile -ExecutionPolicy Bypass -File .\profile-build.ps1 `
    -ConfigPath .\profile-values.yaml `
    -HelpersPath .\profile-helpers-en.yaml `
    -UnixTemplatesPath .\templates
```

---

## ğŸ› Known Issues & Notes

### Resolved
âœ… PowerShell function case-sensitivity (use lowercase function names)  
âœ… YAML property access (use Get-PropertyValue helper)  
âœ… Array trailing commas (use indexed loops)  
âœ… Reserved variable names (avoid $HOME, use $homeDir)  
âœ… Debian auto-loading (create ~/.bash_profile)  
âœ… Windows Terminal mode names (google_cloud not GoogleCloud)

### User Notes
- Custom .bashrc preserved (has nvm, pyenv, auto-nav to amp.dev.20)
- Don't regenerate .bashrc sync - it will overwrite customizations
- Manual bash_profile creation worked perfectly

### Future Testing Needed
- **Google Cloud mode** - May have quirks, handle as they appear
- **AWS mode** - Waiting on SysAdmin to update policies
- **macOS profiles** - Apple Silicon Mac incoming
  - Anticipate Python Intel binary issues in amp.dev

---

## ğŸš€ Next Steps

### Immediate (amp.dev.20 work)
1. âœ… All terminals operational - ready for Claude Code work
2. ğŸ“ Update `profile-helpers-en.yaml` with practical commands as you work
3. ğŸ¯ Begin amp.dev.20 development

### Short-term
1. **Install VS Code** on Windows and macOS
   - Configure UTF-8, Unix line endings
   - Enable Settings Sync
   - Use `code` command consistently

2. **Test Google Cloud terminal**
   - May reveal new issues
   - Follow ADR principles for any fixes

3. **Update helpers**
   - Add real-world commands as you discover them
   - Regenerate profiles to pick up changes

### Medium-term (when Mac arrives)
1. **macOS Profile Generator**
   - Adapt PowerShell generator pattern
   - Create macOS-specific templates
   - Test cross-platform consistency

2. **Python on Apple Silicon**
   - Audit amp.dev for Intel binaries
   - Test/migrate as needed
   - Document issues in lessons learned

3. **AWS Mode Testing**
   - After SysAdmin updates policies
   - Verify API key loading
   - Test AWS CLI integration

### Long-term (amp.dev evolution)
1. **Implement ADR-001 in amp.dev**
   - Audit for hard-coded strings
   - Extract to .po files
   - Set up i18n infrastructure
   - Create build messages config

2. **Create ADR-002: i18n Strategy**
   - Define supported languages
   - Translation workflow
   - Fallback strategies

3. **Schema Validation**
   - Create JSON schemas for all configs
   - Add validation to build pipeline
   - Document configuration options

---

## ğŸ“š Documentation To Load in Next Conversation

### If PowerShell Issues Arise:
```
Load: /mnt/user-data/outputs/lessons-learned-powershell.md
Contains: All PowerShell gotchas and solutions
```

### If Architecture Questions Arise:
```
Load: /mnt/user-data/outputs/ADR-001-Data-Driven-Architecture.md
Contains: Principles, guidelines, examples
```

### If Need Latest Generator:
```
Load: /mnt/user-data/outputs/profile-build.ps1 (v18.0.10)
Or: E:\users\gigster\workspace\dev\profile-generator\profile-build.ps1
```

---

## ğŸ¯ Key Decisions Made This Session

### Technical
1. **Use lowercase function names** in PowerShell (not PascalCase + aliases)
2. **Create ~/.bash_profile** automatically for WSL login shells
3. **Preserve custom .bashrc** (don't overwrite with sync)
4. **Use `code` command** for file editing (VS Code, cross-platform)
5. **Windows Terminal mode names** use underscores (google_cloud)

### Architectural
1. **Data-Driven Architecture** is our standard pattern
2. **No human-readable strings in code** - externalize everything
3. **Build-time binding** preferred over runtime configuration
4. **Schema validation** required for all configs
5. **Three-layer architecture** (Logic â†’ Data â†’ Output)

### Workflow
1. **ADR for major decisions** - create formal records
2. **Lessons learned for gotchas** - prevent repeated mistakes
3. **Version control configs** separately from code
4. **Cross-platform from start** - don't add later

---

## ğŸ’¬ Context for Next Conversation

### Project State
- Profile generator: **Production ready v18.0.10**
- All terminals: **Working perfectly**
- Architecture: **Formalized in ADR-001**
- Next focus: **amp.dev.20 development with Claude Code**

### Open Questions
- How to migrate amp.dev to ADR-001 compliance?
- Best approach for .po file extraction from existing code?
- Schema format for profile-values.yaml?
- macOS generator: Bash script or Swift/Zsh?

### Team Knowledge
- User is experienced developer
- Prefers detailed technical explanations
- Values formal documentation (ADRs, lessons learned)
- Working across Windows/macOS/WSL
- Mission: Multilingual website development (amp.dev)

---

## ğŸ“‹ Quick Commands Reference

### Regenerate Profiles
```powershell
cd E:\users\gigster\workspace\dev\profile-generator
pwsh -NoProfile -ExecutionPolicy Bypass -File .\profile-build.ps1 `
    -ConfigPath .\profile-values.yaml `
    -HelpersPath .\profile-helpers-en.yaml `
    -UnixTemplatesPath .\templates
```

### Check Tool Versions
```powershell
# PowerShell
check-versions

# Bash/WSL
check_versions
```

### Edit Windows Terminal Settings
```
Windows Terminal â†’ Settings (Ctrl+,) â†’ Open JSON file (bottom left)
```

### Edit Files Cross-Platform
```bash
code filename.txt    # Opens in VS Code
```

---

## ğŸ‰ Achievements Summary

**Profile Generator:**
- 9 major versions to get everything working
- Fixed 15+ different issues
- Now stable and production-ready

**Documentation:**
- PowerShell Lessons Learned (4 critical gotchas)
- ADR-001 Data-Driven Architecture (comprehensive)
- Multiple fix summaries tracking evolution

**Development Environment:**
- All terminals auto-loading correctly
- Claude Code verified working
- Cross-platform consistency achieved

**Architecture:**
- Formalized decision-making process
- Established patterns for future projects
- Clear principles for amp.dev evolution

---

## ğŸ”„ Handoff Checklist

Before starting new conversation:

- [x] All files saved to outputs
- [x] Documentation complete
- [x] Current state documented
- [x] Next steps identified
- [x] Open issues listed
- [x] Key decisions recorded
- [x] Commands reference provided
- [x] Context for continuation clear

---

## ğŸ“ Continue From Here

**Next conversation should start with:**

1. **Current focus:** "I'm working on amp.dev.20 with Claude Code"
2. **Reference this:** "See handoff document from 2025-10-27"
3. **Load if needed:** 
   - ADR-001 for architecture questions
   - Lessons Learned for PowerShell issues
   - Latest profile-build.ps1 for generator work

**Key phrase to use:**
> "I have a working profile generator (v18.0.10) and ADR-001 established. Ready to work on amp.dev.20."

---

**Handoff complete. All systems operational. Ready for amp.dev.20 development.** ğŸš€

---

**Document Version:** 1.0  
**Last Updated:** 2025-10-27  
**Status:** Complete  
**Next Review:** When starting new conversation
